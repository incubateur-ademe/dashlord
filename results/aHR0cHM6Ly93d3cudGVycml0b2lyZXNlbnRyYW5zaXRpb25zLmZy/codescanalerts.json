{"totalCount":30,"grade":"D","repositories":[{"url":"https://github.com/incubateur-ademe/territoires-en-transitions","grade":"D","alerts":[{"number":108,"created_at":"2025-10-16T14:04:16Z","updated_at":"2025-10-16T14:04:16Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/108","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/108","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Dev utils' step Uses Step uses 'supabase/setup-cli' with ref 'v1.6.0', not a pinned commit hash"},"location":{"path":".github/workflows/dev.yml","start_line":14,"end_line":14,"start_column":15,"end_column":40},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/108/instances","dismissal_approved_by":null},{"number":107,"created_at":"2025-10-16T14:04:16Z","updated_at":"2025-10-16T14:04:16Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/107","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/107","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/missing-workflow-permissions","severity":"warning","description":"Workflow does not contain permissions","name":"actions/missing-workflow-permissions","tags":["actions","external/cwe/cwe-275","maintainability","security"],"full_description":"Workflows should contain explicit permissions to restrict the scope of the default GITHUB_TOKEN.","help":"## Overview\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendation\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\nname: \"My workflow\"\n# No permissions block\n```\n\n### Correct Usage\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- GitHub Docs: [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"},"location":{"path":".github/workflows/dev.yml","start_line":11,"end_line":25,"start_column":5,"end_column":3},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/107/instances","dismissal_approved_by":null},{"number":106,"created_at":"2025-10-16T14:04:16Z","updated_at":"2025-10-16T14:04:16Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/106","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/106","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/excessive-secrets-exposure","severity":"warning","description":"Excessive Secrets Exposure","name":"actions/excessive-secrets-exposure","tags":["actions","external/cwe/cwe-312","security"],"full_description":"All organization and repository secrets are passed to the workflow runner.","help":"## Overview\n\nWhen the workflow runner cannot determine what secrets are needed to run the workflow, it will pass all the available secrets to the runner including organization and repository secrets. This violates the least privileged principle and increases the impact of a potential vulnerability affecting the workflow.\n\n## Recommendation\n\nOnly pass those secrets that are needed by the workflow. Avoid using expressions such as `toJSON(secrets)` or dynamically accessed secrets such as `secrets[format('GH_PAT_%s', matrix.env)]` since the workflow will need to receive all secrets to decide at runtime which one needs to be used.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\nenv:\n  ALL_SECRETS: ${{ toJSON(secrets) }}\n```\n\n```yaml\nstrategy:\n  matrix:\n    env: [PROD, DEV]\nenv:\n  GH_TOKEN: ${{ secrets[format('GH_PAT_%s', matrix.env)] }}\n```\n\n### Correct Usage\n\n```yaml\nenv:\n  NEEDED_SECRET: ${{ secrets.GH_PAT }}\n```\n\n```yaml\nstrategy:\n  matrix:\n    env: [PROD, DEV]\n---\nif: matrix.env == \"PROD\"\nenv:\n  GH_TOKEN: ${{ secrets.GH_PAT_PROD }}\n---\nif: matrix.env == \"DEV\"\nenv:\n  GH_TOKEN: ${{ secrets.GH_PAT_DEV }}\n```\n\n## References\n\n- GitHub Docs: [Using secrets in GitHub Actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/using-secrets-in-github-actions#using-encrypted-secrets-in-a-workflow).\n- poutine: [Job uses all secrets](https://github.com/boostsecurityio/poutine/blob/main/docs/content/en/rules/job_all_secrets.md).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"All organization and repository secrets are passed to the workflow runner in toJSON(secrets)"},"location":{"path":".github/workflows/init-db.yml","start_line":40,"end_line":40,"start_column":26,"end_column":48},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/106/instances","dismissal_approved_by":null},{"number":99,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/99","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/99","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/code-injection/medium","severity":"warning","description":"Code injection","name":"actions/code-injection/medium","tags":["actions","external/cwe/cwe-094","external/cwe/cwe-095","external/cwe/cwe-116","security"],"full_description":"Interpreting unsanitized user input as code allows a malicious user to perform arbitrary code execution.","help":"## Overview\n\nUsing user-controlled input in GitHub Actions may lead to code injection in contexts like _run:_ or _script:_.\n\nCode injection in GitHub Actions may allow an attacker to exfiltrate any secrets used in the workflow and the temporary GitHub repository authorization token. The token may have write access to the repository, allowing an attacker to make changes to the repository.\n\n## Recommendation\n\nThe best practice to avoid code injection vulnerabilities in GitHub workflows is to set the untrusted input value of the expression to an intermediate environment variable and then use the environment variable using the native syntax of the shell/script interpreter (that is, not _${{ env.VAR }}_).\n\nIt is also recommended to limit the permissions of any tokens used by a workflow such as the GITHUB_TOKEN.\n\n## Example\n\n### Incorrect Usage\n\nThe following example lets attackers inject an arbitrary shell command:\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n      - run: |\n          echo '${{ github.event.comment.body }}'\n```\n\nThe following example uses an environment variable, but **still allows the injection** because of the use of expression syntax:\n\n```yaml\non: issue_comment\n\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n    -  env:\n        BODY: ${{ github.event.issue.body }}\n      run: |\n        echo '${{ env.BODY }}'\n```\n\n### Correct Usage\n\nThe following example uses shell syntax to read the environment variable and will prevent the attack:\n\n```yaml\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n      - env:\n          BODY: ${{ github.event.issue.body }}\n        run: |\n          echo \"$BODY\"\n```\n\nThe following example uses `process.env` to read environment variables within JavaScript code.\n\n```yaml\njobs:\n  echo-body:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: uses: actions/github-script@v4\n        env:\n          BODY: ${{ github.event.issue.body }}\n        with:\n          script: |\n            const { BODY } = process.env\n            ...\n```\n\n## References\n\n- GitHub Security Lab Research: [Keeping your GitHub Actions and workflows secure: Untrusted input](https://securitylab.github.com/research/github-actions-untrusted-input).\n- GitHub Docs: [Security hardening for GitHub Actions](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions).\n- GitHub Docs: [Permissions for the GITHUB_TOKEN](https://docs.github.com/en/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Potential code injection in ${{ github.event.pull_request.head.ref }}, which may be controlled by an external user."},"location":{"path":".github/workflows/cd-test-app-destroy.yml","start_line":29,"end_line":33,"start_column":9,"end_column":67},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/99/instances","dismissal_approved_by":null},{"number":98,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/98","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/98","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'jwalton/gh-docker-logs' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":511,"end_line":511,"start_column":15,"end_column":40},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/98/instances","dismissal_approved_by":null},{"number":96,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/96","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/96","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'cypress-io/github-action' with ref 'v5', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":492,"end_line":492,"start_column":15,"end_column":42},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/96/instances","dismissal_approved_by":null},{"number":93,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/93","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/93","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":458,"end_line":458,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/93/instances","dismissal_approved_by":null},{"number":92,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/92","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/92","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":455,"end_line":455,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/92/instances","dismissal_approved_by":null},{"number":91,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/91","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/91","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":402,"end_line":402,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/91/instances","dismissal_approved_by":null},{"number":90,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/90","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/90","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":399,"end_line":399,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/90/instances","dismissal_approved_by":null},{"number":89,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/89","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/89","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":351,"end_line":351,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/89/instances","dismissal_approved_by":null},{"number":88,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/88","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/88","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":348,"end_line":348,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/88/instances","dismissal_approved_by":null},{"number":87,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/87","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/87","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":325,"end_line":325,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/87/instances","dismissal_approved_by":null},{"number":86,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/86","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/86","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":322,"end_line":322,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/86/instances","dismissal_approved_by":null},{"number":85,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/85","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/85","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":302,"end_line":302,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/85/instances","dismissal_approved_by":null},{"number":84,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/84","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/84","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'pnpm/action-setup' with ref 'v4', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":258,"end_line":258,"start_column":15,"end_column":35},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/84/instances","dismissal_approved_by":null},{"number":83,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/83","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/83","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":221,"end_line":221,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/83/instances","dismissal_approved_by":null},{"number":82,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/82","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/82","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":218,"end_line":218,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/82/instances","dismissal_approved_by":null},{"number":81,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/81","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/81","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":165,"end_line":165,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/81/instances","dismissal_approved_by":null},{"number":80,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/80","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/80","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":162,"end_line":162,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/80/instances","dismissal_approved_by":null},{"number":79,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/79","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/79","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'test-api' step Uses Step uses 'denoland/setup-deno' with ref 'v2', not a pinned commit hash"},"location":{"path":".github/workflows/test-api.yml","start_line":22,"end_line":22,"start_column":15,"end_column":37},"classifications":["test"]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/79/instances","dismissal_approved_by":null},{"number":78,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/78","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/78","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":108,"end_line":108,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/78/instances","dismissal_approved_by":null},{"number":77,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/77","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/77","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":105,"end_line":105,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/77/instances","dismissal_approved_by":null},{"number":76,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/76","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/76","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Dev utils' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/dev.yml","start_line":44,"end_line":44,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/76/instances","dismissal_approved_by":null},{"number":75,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/75","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/75","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'supabase/setup-cli' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":70,"end_line":70,"start_column":15,"end_column":36},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/75/instances","dismissal_approved_by":null},{"number":74,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/74","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/74","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":67,"end_line":67,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/74/instances","dismissal_approved_by":null},{"number":72,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/72","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/72","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":44,"end_line":44,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/72/instances","dismissal_approved_by":null},{"number":71,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/71","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/71","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Déploiement à la demande de l'api d'automatisation technique' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/cd-tools.yml","start_line":49,"end_line":49,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/71/instances","dismissal_approved_by":null},{"number":70,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/70","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/70","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Intégration continue' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/ci-v1.yml","start_line":19,"end_line":19,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/70/instances","dismissal_approved_by":null},{"number":69,"created_at":"2025-10-09T09:28:57Z","updated_at":"2025-10-09T09:28:57Z","url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/69","html_url":"https://github.com/incubateur-ademe/territoires-en-transitions/security/code-scanning/69","assignees":[],"state":"open","fixed_at":null,"dismissed_by":null,"dismissed_at":null,"dismissed_reason":null,"dismissed_comment":null,"rule":{"id":"actions/unpinned-tag","severity":"warning","description":"Unpinned tag for a non-immutable Action in workflow","name":"actions/unpinned-tag","tags":["actions","external/cwe/cwe-829","security"],"full_description":"Using a tag for a non-immutable Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.","help":"## Overview\n\nUsing a tag for a 3rd party Action that is not pinned to a commit can lead to executing an untrusted Action through a supply chain attack.\n\n## Recommendation\n\nPinning an action to a full length commit SHA is currently the only way to use a non-immutable action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.\n\n## Example\n\n### Incorrect Usage\n\n```yaml\n- uses: tj-actions/changed-files@v44\n```\n\n### Correct Usage\n\n```yaml\n- uses: tj-actions/changed-files@c65cd883420fd2eb864698a825fc4162dd94482c # v44\n```\n\n## References\n\n- GitHub Docs: [Using third-party actions](https://docs.github.com/en/actions/security-for-github-actions/security-guides/security-hardening-for-github-actions#using-third-party-actions).\n","security_severity_level":"medium"},"tool":{"name":"CodeQL","guid":null,"version":"2.23.3"},"most_recent_instance":{"ref":"refs/heads/main","analysis_key":"dynamic/github-code-scanning/codeql:analyze","environment":"{\"build-mode\":\"none\",\"category\":\"/language:actions\",\"language\":\"actions\",\"runner\":\"[\\\"ubuntu-latest\\\"]\"}","category":"/language:actions","state":"open","commit_sha":"f478419a63b6c997d8ab2c06d0f7640f6354b679","message":{"text":"Unpinned 3rd party Action 'Synchronise la base de données de staging avec la base de données de production' step Uses Step uses 'earthly/actions-setup' with ref 'v1', not a pinned commit hash"},"location":{"path":".github/workflows/cd-sync.yml","start_line":24,"end_line":24,"start_column":15,"end_column":39},"classifications":[]},"instances_url":"https://api.github.com/repos/incubateur-ademe/territoires-en-transitions/code-scanning/alerts/69/instances","dismissal_approved_by":null}]}]}